!function(a,b){"function"==typeof define&&define.amd?define([],function(){var c=b();return a.LocalStorage=c,c}):"undefined"!=typeof exports?module.exports=b():a.LocalStorage=b()}(this,function(){var a=!1,b=[Object,Number,String,Array,Date,Boolean],c=function(a,b){this.name="LocalStorageException",this.message=a,this.value=b};if(!this.localStorage)throw new c("Local storage is not supported by your configuration. Sorry :(");var d=function(a,b){if(!a)throw new c("A LocalStorage instance must have a name");b=b&&b.constructor===Object?b:{};var d,e=a,f={},g={blockingValidation:!1,usePromises:!1},h=g;Object.keys(g).forEach(function(a){b.hasOwnProperty(a)&&(h[a]=b[a])}),Object.defineProperty(this,"options",{enumerable:!0,get:function(){return h},set:function(a){if(a.constructor!==Object)throw new c("Cannot set the options property to anything other than an object.");h=a}}),Object.defineProperty(this,"name",{enumerable:!0,get:function(){return e}}),Object.defineProperty(this,"validators",{enumerable:!0,get:function(){return f},set:function(a){if(a.constructor!==Object)throw new c("Cannot set the validators property to anything other than an object. You shouldn't write this property directly anyways!");f=a}}),Object.defineProperty(this,"Promise",{enumerable:!0,get:function(){if(!d&&window.Promise&&(d=window.Promise),!d)throw new c("Promises are not supported by your configuration, but you might try with a library or a polyfill!");return d},set:function(a){if(a.constructor!==Function)throw new c("Promise implementation must be a constructor.");d=a}})};return d.get=function(a){var b=localStorage.getItem(a);return b&&(b=JSON.parse(b)),b},d.set=function(d,e){if(!e)throw new c("No value has been passed");if(a===!0&&-1===b.indexOf(e.constructor))throw new c("Cannot serialize value",e);localStorage.setItem(d,JSON.stringify(e))},d.remove=function(a){localStorage.removeItem(a)},d.clear=function(){Object.keys(localStorage).forEach(function(a){d.remove(a)})},d.allowConstructor=function(a){b.push(a)},d.toggleConstructorCheck=function(b){a=b},d.prototype.get=function(a){return d.get(this.name+":"+a)},d.prototype.set=function(a,b,e){var f=e&&e.constructor===Function&&!e(b)||!e&&this.validators[a]&&!this.validators[a](b);if(this.options.usePromises===!0){var g=new this.Promise(function(e,g){return f?g(this.options.blockingValidation===!0?new c('Validation failed for key "'+a+'"',b):!1):(d.set(this.name+":"+a,b),e(this))}.bind(this));return g}if(f){if(this.options.blockingValidation===!0)throw new c('Validation failed for key "'+a+'"',b);return!1}return d.set(this.name+":"+a,b),this},d.prototype.remove=function(a){return d.remove(this.name+":"+a),this},d.prototype.all=function(){var a={},b=new RegExp("^"+this.name+":.+$");return Object.keys(localStorage).forEach(function(c){b.test(c)&&(a[c.substr(this.name.length+1)]=d.get(c))}.bind(this)),a},d.prototype.clear=function(){var a=new RegExp("^"+this.name+":.+$");return Object.keys(localStorage).forEach(function(b){a.test(b)&&d.remove(b)}.bind(this)),this},d.prototype.setValidator=function(a,b){if(b.constructor!==Function)throw new c("A validator must be a function!");return this.validators[a]=b,this},d.prototype.clearValidator=function(a){return this.validators[a]&&delete this.validators[a],this},d.prototype.clearValidators=function(){return this.validators={},this},d});